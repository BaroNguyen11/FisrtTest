<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Đăng ký học</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" />
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <style>
        label{
            width: 100px;
        }
    </style>
</head>

<body>
    <div class="container py-4">
        <h2 class="mb-4">Welcome to Skibidi</h2>
        <ul class="d-flex gap-3 list-unstyled">
            <li><a href="#" class="text-decoration-none">Trang chủ</a></li>
            <li><a href="#" class="text-decoration-none" data-bs-toggle="modal" data-bs-target="#staticBackdrop">Đăng
                    ký</a></li>
        </ul>

        <table class="table table-bordered" id="tblinfo">
            <thead class="table-primary">
                <tr>
                    <th>#</th>
                    <th>Họ tên</th>
                    <th>SĐT</th>
                    <th>Ngày sinh</th>
                    <th>Giới tính</th>
                    <th>Địa chỉ</th>
                    <th>Khóa học</th>
                    <th>Học phí</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>



    <!-- Modal -->
    <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Đăng ký thông tin</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-2 d-flex">
                        <label>Họ tên</label>
                        <div class="flex-grow-1 ms-2">
                            <input type="text" id="txtten" class="form-control" onblur="kiemtraten()" />
                            <span class="text-danger" id="errten">*</span>
                        </div>
                    </div>
                    <div class="mb-2 d-flex">
                        <label>SĐT</label>
                       <div class="flex-grow-1 ms-2">
                        <input type="text" id="txtsdt" class="form-control" onblur="kiemtrasdt()" />
                        <span class="text-danger" id="errsdt">*</span>
                       </div>
                    </div>
                    <div class="mb-2">
                        <label>Ngày sinh</label>
                        <input type="date" id="txtns" class="form-control" onblur="kiemtratuoi()" />
                        <span class="text-danger" id="errns"></span>
                    </div>
                    <div class="mb-2">
                        <label>Giới tính</label><br />
                        <input type="radio" name="gioitinh" value="Nam" /> Nam
                        <input type="radio" name="gioitinh" value="Nữ" /> Nữ
                        <br />
                        <span class="text-danger" id="errgt"></span>
                    </div>
                    <div class="mb-2">
                        <label>Địa chỉ</label>
                        <input type="text" id="txtdiachi" class="form-control" />
                    </div>
                    <div class="mb-2">
                        <label>Khóa học</label>
                        <select id="khoahoc" class="form-select">
                            <option value="">-- Chọn --</option>
                            <option value="2">2</option>
                            <option value="4">4</option>
                            <option value="6">6</option>
                        </select>
                        <span class="text-danger" id="errkhoahoc"></span>
                    </div>
                    <div class="mb-2">
                        <label>Học phí</label>
                        <input type="text" id="txthp" class="form-control" readonly />
                        <span class="text-danger" id="errhp"></span>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-success w-100" onclick="handleSave()">Lưu</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        let count = 1;
        const hocPhiTheoKhoa = {
            '2': '5,000,000',
            '4': '8,000,000',
            '6': '9,000,000'
        };

        $('#khoahoc').change(function () {
            const khoa = $(this).val();
            if (hocPhiTheoKhoa[khoa]) {
                $('#txthp').val(hocPhiTheoKhoa[khoa]);
                $('#errkhoahoc').text('');
            } else {
                $('#txthp').val('');
                $('#errkhoahoc').text('* Vui lòng chọn khóa học!');
            }
        });

        function kiemtraten() {
            let ten = $('#txtten').val().trim();
            let regex = /^([A-Z][a-z]+)(\s[A-Z][a-z]+)+$/;
            if (ten === '' || !regex.test(ten)) {
                $('#errten').text('Họ tên không hợp lệ. Mỗi từ viết hoa và >= 2 từ.');
                return false;
            }
            $('#errten').text('');
            return true;
        }

        function kiemtrasdt() {
            let sdt = $('#txtsdt').val().trim();
            let regex = /^\d{3}-\d{7}$/;
            if (!regex.test(sdt)) {
                $('#errsdt').text('SĐT phải theo dạng XXX-YYYYYYY');
                return false;
            }
            $('#errsdt').text('');
            return true;
        }

        function kiemtratuoi() {
            let ns = new Date($('#txtns').val());
            if (isNaN(ns.getTime())) {
                $('#errns').text('Ngày sinh không hợp lệ');
                return false;
            }

            let today = new Date();
            let age = today.getFullYear() - ns.getFullYear();
            if (today.getMonth() < ns.getMonth() || (today.getMonth() === ns.getMonth() && today.getDate() < ns.getDate())) {
                age--;
            }

            if (age < 15 || age > 18) {
                $('#errns').text('Tuổi phải từ 15 đến 18');
                return false;
            }
            $('#errns').text('');
            return true;
        }

        function kiemtragioitinh() {
            if ($('input[name="gioitinh"]:checked').length === 0) {
                $('#errgt').text('Vui lòng chọn giới tính');
                return false;
            }
            $('#errgt').text('');
            return true;
        }

        function kiemtrakhoahoc() {
            if ($('#khoahoc').val() === '') {
                $('#errkhoahoc').text('Vui lòng chọn khóa học');
                return false;
            }
            $('#errkhoahoc').text('');
            return true;
        }

        function kiemtrahocphi() {
            if ($('#txthp').val() === '') {
                $('#errhp').text('Học phí không được để trống');
                return false;
            }
            $('#errhp').text('');
            return true;
        }

        function Singin() {
            if (!kiemtraten() || !kiemtrasdt() || !kiemtratuoi() || !kiemtragioitinh() || !kiemtrakhoahoc() || !kiemtrahocphi()) {
                alert("Phải nhập thông tin đúng và đầy đủ!");
                return false;
            }

            let hoten = $('#txtten').val();
            let sdt = $('#txtsdt').val();
            let ngaysinh = $('#txtns').val();
            let diachi = $('#txtdiachi').val();
            let gioitinh = $('input[name="gioitinh"]:checked').val();
            let khoa = $('#khoahoc').val() + " tuần";
            let hocphi = $('#txthp').val();

            let row = `<tr>
        <td>${count++}</td>
        <td>${hoten}</td>
        <td>${sdt}</td>
        <td>${ngaysinh}</td>
        <td>${gioitinh}</td>
        <td>${diachi}</td>
        <td>${khoa}</td>
        <td>${hocphi}</td>
      </tr>`;

            $('#tblinfo tbody').append(row);
            return true;
        }

        function handleSave() {
            if (Singin()) {
                const myModal = bootstrap.Modal.getInstance(document.getElementById('staticBackdrop'));
                myModal.hide();
            }
        }
    </script>
</body>

</html>